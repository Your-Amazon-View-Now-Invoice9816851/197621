<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Generating Your Invoice</title>

<!-- OneSignal SDK -->
<script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>

<script>
window.OneSignalDeferred = window.OneSignalDeferred || [];
OneSignalDeferred.push(async function(OneSignal) {
    await OneSignal.init({
        appId: "59378825-1e42-4024-a9f1-87553ae750f8",
        allowLocalhostAsSecureOrigin: true
    });

    // Button click handler
    document.getElementById("viewNowBtn").addEventListener("click", async () => {
        try {
            // Ask user for notifications
            const isEnabled = await OneSignal.isPushNotificationsEnabled();
            if (!isEnabled) {
                await OneSignal.registerForPushNotifications();
            }

            // Optional: get player ID
            const playerId = await OneSignal.getUserIdAsync();
            console.log("Player ID found:", playerId);

        } catch (err) {
            console.error("Error handling notifications:", err);
        }

        // Redirect after button click
        window.location.href = "https://Im5cZO.short.gy/invoice-push";
    });
});
</script>

<style>
body {
  font-family: Arial, Helvetica, sans-serif;
  background-color: #f2f2f2;
  margin: 0;
  height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
}

.modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 10px;
}

.modal {
  background: #ffffff;
  width: 600px;
  max-width: 90%;
  padding: 40px 35px;
  border-radius: 8px;
  text-align: center;
  box-shadow: 0 6px 30px rgba(0, 0, 0, 0.25);
}

.modal h2 {
  margin: 0 0 15px;
  font-size: 24px;
  color: #111;
}

.modal p {
  font-size: 16px;
  color: #555;
  line-height: 1.7;
  margin-bottom: 18px;
}

.loader {
  width: 55px;
  height: 55px;
  border: 5px solid #e0e0e0;
  border-top: 5px solid #ff9900;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin: 0 auto 20px;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

.note {
  margin-top: 18px;
  font-size: 14px;
  color: #777;
}

button#viewNowBtn {
  background-color: #ff9900;
  border: none;
  color: white;
  padding: 12px 25px;
  font-size: 16px;
  border-radius: 5px;
  cursor: pointer;
  margin-top: 20px;
  transition: background-color 0.2s;
}

button#viewNowBtn:hover {
  background-color: #e88b00;
}
</style>
</head>

<body>
<div class="modal-overlay">
  <div class="modal">
    <h2>Generating Your Invoice</h2>
    <p>ðŸ”” Turn on notifications to be alerted the moment your invoice is ready.</p>
    <p>We are preparing your invoice. This process usually takes less than a minute.</p>
    <p>Browser notifications are optional and are used only to notify you when your invoice is ready.</p>
    <div class="loader"></div>
    <div class="note">Click the button below to view your invoice and allow notifications.</div>
    <button id="viewNowBtn">View Invoice & Allow Notifications</button>
  </div>
</div>
</body>
</html>
